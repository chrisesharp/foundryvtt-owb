{"name":"Reload","permission":{"default":0,"2ins83sY7CMjwWHS":3},"type":"script","flags":{"core":{"sourceId":"Macro.zEs5sUofYOrbbFkN"}},"scope":"global","command":"function getAmmo(token) {\n    return token.actor.data.items.find(f => f.name.includes(\"Ammunition\") && f.type === \"item\");\n}\nfunction reloadAmmo(token, ammo) {\n    ammo.data.quantity.value = Math.max(0,ammo.data.quantity.max);\n    token.actor.updateEmbeddedEntity(\"OwnedItem\", {...ammo});\n}\n\nif (token) {\n    const ammo = getAmmo(token);\n    const emptyAmmo = (ammo && ammo.data.quantity.value === 0);\n    if (emptyAmmo) {\n        reloadAmmo(token, ammo);\n    }\n}","author":"2ins83sY7CMjwWHS","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"p7pmKcvffJyRb7BW"}
{"name":"Reload","permission":{"default":0,"2ins83sY7CMjwWHS":3},"type":"script","flags":{"core":{"sourceId":"Macro.zEs5sUofYOrbbFkN"}},"scope":"global","command":"function getAmmo(token) {\n    return token.actor.data.items.find(f => f.name.includes(\"Ammunition\") && f.type === \"item\");\n}\nfunction reloadAmmo(token, ammo) {\n    ammo.data.quantity.value = Math.max(0,ammo.data.quantity.max);\n    token.actor.updateEmbeddedEntity(\"OwnedItem\", {...ammo});\n}\n\nif (token) {\n    const ammo = getAmmo(token);\n    const emptyAmmo = (ammo && ammo.data.quantity.value < ammo.data.quantity.max);\n    if (emptyAmmo) {\n        reloadAmmo(token, ammo);\n        var messageContent = `Reloaded ${ammo.name}`;\n        var chatData = {\n            user: game.user._id,\n            speaker: ChatMessage.getSpeaker(),\n            content: messageContent};\n        \n        ChatMessage.create(chatData, {});\n    }\n}","author":"2ins83sY7CMjwWHS","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"pwmopVBISyGrDhXt"}
{"$$deleted":true,"_id":"p7pmKcvffJyRb7BW"}
{"$$deleted":true,"_id":"pwmopVBISyGrDhXt"}
{"name":"Reload","permission":{"default":0,"2ins83sY7CMjwWHS":3},"type":"script","flags":{"core":{"sourceId":"Macro.zEs5sUofYOrbbFkN"}},"scope":"global","command":"function getAmmo(token) {\n    return token.actor.data.items.find(f => f.name.includes(\"Ammunition\") && f.type === \"item\");\n}\nfunction reloadAmmo(token, ammo) {\n    ammo.data.quantity.value = Math.max(0,ammo.data.quantity.max);\n    token.actor.updateEmbeddedEntity(\"OwnedItem\", {...ammo});\n}\n\nif (token) {\n    const ammo = getAmmo(token);\n    const emptyAmmo = (ammo && ammo.data.quantity.value < ammo.data.quantity.max);\n    if (emptyAmmo) {\n        reloadAmmo(token, ammo);\n        var messageContent = `Reloaded ${ammo.name}`;\n        var chatData = {\n            user: game.user._id,\n            speaker: ChatMessage.getSpeaker(),\n            content: messageContent};\n        \n        ChatMessage.create(chatData, {});\n    }\n}","author":"2ins83sY7CMjwWHS","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"bL6f7rrfuuTnF7Uo"}
